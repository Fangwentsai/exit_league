# 輪播圖顯示問題修復報告

## 🔴 問題描述

用戶反映：
1. ❌ 輪播照片不會顯示（只看到載入指示器）
2. ❌ 標題太大了
3. ❌ 文字沒有陰影

## 🔍 問題診斷

### 問題 1：輪播圖不顯示

**根本原因**：CSS 層級衝突

```css
/* 問題：載入指示器覆蓋了圖片 */
.carousel-loading {
    z-index: 10;      /* 載入指示器在最上面 */
    display: flex;    /* 一直顯示 ❌ */
}

#carousel-image {
    z-index: 2;       /* 圖片在下面，被覆蓋 */
}
```

**結果**：
- 圖片已經載入（IMG_9918.webp 存在）✅
- 但被「載入照片中...」覆蓋住 ❌

### 問題 2：重複的 CSS 定義

```css
/* 第一次定義 */
#carousel-image {
    opacity: 1;
    z-index: 2;  ✅
}

/* 第二次定義（覆蓋了第一次）*/
#carousel-image {
    z-index: 1;  ❌ 錯誤！
}
```

### 問題 3：樣式問題

- 標題太大（手機版 16px，應該 14px）
- 陰影太淡（1px，應該 2px）

---

## ✅ 解決方案

### 1. 修正載入指示器

```css
/* 修改前 ❌ */
.carousel-loading {
    display: flex;
    z-index: 10;
}

/* 修改後 ✅ */
.carousel-loading {
    display: none;    /* 默認隱藏！ */
    z-index: 5;       /* 降低層級 */
}

.carousel-loading.visible {
    display: flex;
}
```

**說明**：
- 因為首圖已在 HTML 中直接設定 `src`
- 不需要載入指示器
- 默認隱藏，避免覆蓋圖片

### 2. 移除重複的 CSS

```css
/* 只保留正確的定義 ✅ */
#carousel-image {
    opacity: 1;
    z-index: 2;
}

#carousel-image-next {
    opacity: 0;
    z-index: 1;
}

/* 移除重複的錯誤定義 ❌ */
```

### 3. 調整標題樣式

```css
/* 基本樣式 */
.carousel-title {
    font-size: 16px;     /* 從 18px 降低 */
    text-shadow: 2px 2px 4px rgba(0,0,0,0.9);  /* 加強陰影 */
}

/* 手機版 */
@media (max-width: 768px) {
    .carousel-title {
        font-size: 14px;  /* 從 16px 降低 */
    }
}

/* 桌面版 */
@media (min-width: 769px) {
    .carousel-title {
        font-size: 18px;  /* 從 20px 降低 */
    }
}
```

---

## 📊 修復對比

### 層級結構

| 元素 | 修改前 | 修改後 |
|------|-------|-------|
| **carousel-loading** | z-index: 10, display: flex | z-index: 5, display: none |
| **carousel-image** | z-index: 1 (錯誤) | z-index: 2 ✅ |
| **carousel-image-next** | z-index: 2 (錯誤) | z-index: 1 ✅ |
| **carousel-overlay** | z-index: 10 | z-index: 10 |

### 標題大小

| 裝置 | 修改前 | 修改後 |
|------|-------|-------|
| **手機** | 16px | 14px |
| **平板** | 16px | 16px |
| **桌面** | 20px | 18px |

### 文字陰影

| 屬性 | 修改前 | 修改後 |
|------|-------|-------|
| **text-shadow** | 1px 1px 2px rgba(0,0,0,0.8) | 2px 2px 4px rgba(0,0,0,0.9) |

---

## 🎯 預期效果

### 修改後應該看到

1. ✅ **輪播圖立即顯示**
   - 第一張圖片（IMG_9918.webp）立即可見
   - 沒有「載入照片中...」覆蓋
   - 圖片清晰顯示

2. ✅ **標題大小適中**
   - 手機：14px（不會太大）
   - 桌面：18px（適中）

3. ✅ **文字陰影清晰**
   - 白色文字在圖片上清楚可見
   - 陰影加強，提高對比度

4. ✅ **輪播功能正常**
   - 7 秒自動切換
   - 圓點指示器正常
   - 滑鼠懸停暫停

---

## 🧪 測試步驟

### 1. 清除快取

```
Ctrl + Shift + R (Windows)
Cmd + Shift + R (Mac)
```

### 2. 檢查 Console

應該看到：
```
✅ 輪播圖初始化完成（首圖已預載）
```

### 3. 檢查 Network

應該看到：
```
✅ IMG_9918.webp (131 KB, image/webp)
   Status: 200 OK
   Priority: High
```

### 4. 檢查視覺效果

- ✅ 圖片立即顯示
- ✅ 標題大小適中
- ✅ 文字陰影清晰
- ✅ 沒有載入指示器覆蓋

---

## 📝 技術總結

### 關鍵學習

#### 1. CSS 層級管理

**原則**：
```
背景圖片（z-index: 1-2）
  ↓
載入指示器（z-index: 5）
  ↓
文字覆蓋層（z-index: 10+）
```

**錯誤示範**：
```css
/* 載入指示器不應該一直顯示 */
.loading {
    display: flex;  ❌
    z-index: 999;   ❌
}
```

**正確做法**：
```css
/* 默認隱藏，需要時才顯示 */
.loading {
    display: none;      ✅
    z-index: 5;         ✅ 適中的層級
}
```

#### 2. LCP 優化的副作用

**問題**：
- 為了優化 LCP，首圖直接在 HTML 設定 `src`
- 但忘記隱藏載入指示器
- 導致圖片被覆蓋

**解決**：
```javascript
// JavaScript 執行時立即隱藏
if (carouselLoading) carouselLoading.style.display = 'none';
```

**更好的做法**：
```css
/* 在 CSS 中就設定為隱藏 */
.carousel-loading {
    display: none;  /* 首圖不需要載入指示器 */
}
```

#### 3. 響應式字體大小

**原則**：
- 手機：較小（14px）
- 平板：適中（16px）
- 桌面：較大（18px）

**避免**：
- ❌ 手機字體太大（佔用太多空間）
- ❌ 桌面字體太小（看不清楚）

---

## 🔧 代碼變更摘要

### CSS 變更

```diff
.carousel-loading {
-   display: flex;
+   display: none;
-   z-index: 10;
+   z-index: 5;
}

- #carousel-image { z-index: 1; }  /* 移除重複定義 */
- #carousel-image-next { z-index: 2; }

.carousel-title {
-   font-size: 18px;
+   font-size: 16px;
-   text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
+   text-shadow: 2px 2px 4px rgba(0,0,0,0.9);
}

@media (max-width: 768px) {
    .carousel-title {
-       font-size: 16px;
+       font-size: 14px;
    }
}

@media (min-width: 769px) {
    .carousel-title {
-       font-size: 20px;
+       font-size: 18px;
    }
}
```

### JavaScript 變更

無需變更（已正確實現）

---

## ✅ 完成狀態

| 項目 | 狀態 |
|------|------|
| 修復輪播圖顯示 | ✅ 完成 |
| 移除 CSS 重複定義 | ✅ 完成 |
| 調整標題大小 | ✅ 完成 |
| 加強文字陰影 | ✅ 完成 |
| 隱藏載入指示器 | ✅ 完成 |

---

**修復日期**：2025/12/01  
**影響頁面**：pages/news.html  
**測試狀態**：等待用戶驗證  
**預期結果**：輪播圖正常顯示，樣式適中

