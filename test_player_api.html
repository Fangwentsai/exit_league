<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Season 3 é¸æ‰‹è¡¨ç¾æ¸¬è©¦</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .player-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            background: #f9f9f9;
        }
        .team-card {
            border: 2px solid #007bff;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            background: #f8f9fa;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        .stat-item {
            background: white;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            border: 1px solid #eee;
        }
        .set-performance {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 5px;
            margin-top: 10px;
        }
        .set-item {
            padding: 8px 4px;
            text-align: center;
            border-radius: 4px;
            font-size: 12px;
        }
        .excellent { background-color: #28a745; color: white; }
        .good { background-color: #17a2b8; color: white; }
        .average { background-color: #ffc107; color: black; }
        .below_average { background-color: #fd7e14; color: white; }
        .poor { background-color: #dc3545; color: white; }
        .insufficient_data { background-color: #6c757d; color: white; }
        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }
        .error {
            color: #dc3545;
            background: #f8d7da;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .success {
            color: #155724;
            background: #d4edda;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        h1 { color: #333; text-align: center; }
        h2 { color: #007bff; border-bottom: 2px solid #007bff; padding-bottom: 5px; }
        h3 { color: #666; margin-bottom: 10px; }
        .test-info {
            background: #e9ecef;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>ğŸ¯ Season 3 é¸æ‰‹è¡¨ç¾æ¸¬è©¦</h1>
    
    <div class="container">
        <div class="test-info">
            <h3>ğŸ“‹ æ¸¬è©¦èªªæ˜</h3>
            <p><strong>å¦‚æœæ‚¨çœ‹åˆ°CORSéŒ¯èª¤ï¼Œæœ‰å…©ç¨®è§£æ±ºæ–¹æ¡ˆï¼š</strong></p>
            <ol>
                <li><strong>ä½¿ç”¨HTTPæœå‹™å™¨</strong>ï¼šåœ¨çµ‚ç«¯æ©ŸåŸ·è¡Œ <code>python3 -m http.server 8000</code>ï¼Œç„¶å¾Œè¨ªå• <code>http://localhost:8000/test_player_api.html</code></li>
                <li><strong>ä½¿ç”¨å…§åµŒæ¸¬è©¦æ•¸æ“š</strong>ï¼šé»æ“Šä¸‹æ–¹æŒ‰éˆ•ä½¿ç”¨é è¨­çš„æ¸¬è©¦æ•¸æ“š</li>
            </ol>
        </div>
        
        <button onclick="runMockTests()" style="background: #28a745; color: white; padding: 12px 24px; border: none; border-radius: 5px; font-size: 16px; cursor: pointer; margin-bottom: 20px;">
            ğŸ§ª åŸ·è¡Œå…§åµŒæ¸¬è©¦æ•¸æ“š
        </button>
    </div>

    <div class="container">
        <h2>é¸æ‰‹è¡¨ç¾æ¸¬è©¦</h2>
        <div id="players-results">
            <div class="loading">ç­‰å¾…æ¸¬è©¦åŸ·è¡Œ...</div>
        </div>
    </div>

    <div class="container">
        <h2>éšŠä¼è¡¨ç¾æ¸¬è©¦</h2>
        <div id="teams-results">
            <div class="loading">ç­‰å¾…æ¸¬è©¦åŸ·è¡Œ...</div>
        </div>
    </div>

    <script>
        // å…§åµŒæ¸¬è©¦æ•¸æ“šï¼ˆå¾ä¿®æ­£å¾Œçš„season3_player_performance_corrected.jsonæå–çš„æ•¸æ“šï¼‰
        const mockPlayerData = {
            "Ace": {
                "name": "Ace",
                "teams": ["é€ƒç”Ÿå…¥å£C"],
                "total_sets_played": 61,
                "total_sets_won": 26,
                "total_win_rate": 42.6,
                "matches_played": 13,
                "set_details": {
                    "1": {"played": 0, "won": 0, "win_rate": 0.0},
                    "2": {"played": 0, "won": 0, "win_rate": 0.0},
                    "3": {"played": 1, "won": 1, "win_rate": 100.0},
                    "4": {"played": 0, "won": 0, "win_rate": 0.0},
                    "5": {"played": 11, "won": 3, "win_rate": 27.3},
                    "6": {"played": 1, "won": 0, "win_rate": 0.0},
                    "7": {"played": 8, "won": 4, "win_rate": 50.0},
                    "8": {"played": 1, "won": 0, "win_rate": 0.0},
                    "9": {"played": 0, "won": 0, "win_rate": 0.0},
                    "10": {"played": 8, "won": 5, "win_rate": 62.5},
                    "11": {"played": 3, "won": 1, "win_rate": 33.3},
                    "12": {"played": 0, "won": 0, "win_rate": 0.0},
                    "13": {"played": 10, "won": 3, "win_rate": 30.0},
                    "14": {"played": 0, "won": 0, "win_rate": 0.0},
                    "15": {"played": 6, "won": 3, "win_rate": 50.0},
                    "16": {"played": 12, "won": 6, "win_rate": 50.0}
                }
            },
            "Lucas": {
                "name": "Lucas",
                "teams": ["é€ƒç”Ÿå…¥å£A"],
                "total_sets_played": 73,
                "total_sets_won": 30,
                "total_win_rate": 41.1,
                "matches_played": 14,
                "set_details": {
                    "1": {"played": 4, "won": 2, "win_rate": 50.0},
                    "2": {"played": 0, "won": 0, "win_rate": 0.0},
                    "3": {"played": 5, "won": 3, "win_rate": 60.0},
                    "4": {"played": 1, "won": 0, "win_rate": 0.0},
                    "5": {"played": 13, "won": 4, "win_rate": 30.8},
                    "6": {"played": 0, "won": 0, "win_rate": 0.0},
                    "7": {"played": 3, "won": 1, "win_rate": 33.3},
                    "8": {"played": 3, "won": 0, "win_rate": 0.0},
                    "9": {"played": 3, "won": 2, "win_rate": 66.7},
                    "10": {"played": 1, "won": 0, "win_rate": 0.0},
                    "11": {"played": 10, "won": 5, "win_rate": 50.0},
                    "12": {"played": 2, "won": 1, "win_rate": 50.0},
                    "13": {"played": 5, "won": 4, "win_rate": 80.0},
                    "14": {"played": 3, "won": 0, "win_rate": 0.0},
                    "15": {"played": 11, "won": 7, "win_rate": 63.6},
                    "16": {"played": 9, "won": 1, "win_rate": 11.1}
                }
            },
            "è€ä¸¹": {
                "name": "è€ä¸¹",
                "teams": ["Viviæœé…’æ™šèˆ"],
                "total_sets_played": 56,
                "total_sets_won": 42,
                "total_win_rate": 75.0,
                "matches_played": 13,
                "set_details": {
                    "1": {"played": 0, "won": 0, "win_rate": 0.0},
                    "2": {"played": 8, "won": 5, "win_rate": 62.5},
                    "3": {"played": 3, "won": 2, "win_rate": 66.7},
                    "4": {"played": 0, "won": 0, "win_rate": 0.0},
                    "5": {"played": 5, "won": 4, "win_rate": 80.0},
                    "6": {"played": 0, "won": 0, "win_rate": 0.0},
                    "7": {"played": 3, "won": 3, "win_rate": 100.0},
                    "8": {"played": 2, "won": 2, "win_rate": 100.0},
                    "9": {"played": 2, "won": 2, "win_rate": 100.0},
                    "10": {"played": 6, "won": 4, "win_rate": 66.7},
                    "11": {"played": 1, "won": 0, "win_rate": 0.0},
                    "12": {"played": 4, "won": 3, "win_rate": 75.0},
                    "13": {"played": 4, "won": 2, "win_rate": 50.0},
                    "14": {"played": 6, "won": 4, "win_rate": 66.7},
                    "15": {"played": 6, "won": 5, "win_rate": 83.3},
                    "16": {"played": 6, "won": 6, "win_rate": 100.0}
                }
            },
            "å°è–©": {
                "name": "å°è–©",
                "teams": ["æµ·ç›œæªç¡¬"],
                "total_sets_played": 72,
                "total_sets_won": 54,
                "total_win_rate": 75.0,
                "matches_played": 14,
                "set_details": {
                    "1": {"played": 1, "won": 1, "win_rate": 100.0},
                    "2": {"played": 3, "won": 3, "win_rate": 100.0},
                    "3": {"played": 2, "won": 1, "win_rate": 50.0},
                    "4": {"played": 6, "won": 5, "win_rate": 83.3},
                    "5": {"played": 3, "won": 1, "win_rate": 33.3},
                    "6": {"played": 0, "won": 0, "win_rate": 0.0},
                    "7": {"played": 2, "won": 1, "win_rate": 50.0},
                    "8": {"played": 4, "won": 2, "win_rate": 50.0},
                    "9": {"played": 5, "won": 5, "win_rate": 100.0},
                    "10": {"played": 7, "won": 6, "win_rate": 85.7},
                    "11": {"played": 0, "won": 0, "win_rate": 0.0},
                    "12": {"played": 8, "won": 6, "win_rate": 75.0},
                    "13": {"played": 5, "won": 3, "win_rate": 60.0},
                    "14": {"played": 7, "won": 5, "win_rate": 71.4},
                    "15": {"played": 8, "won": 5, "win_rate": 62.5},
                    "16": {"played": 12, "won": 10, "win_rate": 83.3}
                }
            },
            "èˆ¹é•·": {
                "name": "èˆ¹é•·",
                "teams": ["æµ·ç›œæªç¡¬"],
                "total_sets_played": 27,
                "total_sets_won": 19,
                "total_win_rate": 70.4,
                "matches_played": 14,
                "set_details": {
                    "1": {"played": 2, "won": 2, "win_rate": 100.0},
                    "2": {"played": 2, "won": 2, "win_rate": 100.0},
                    "3": {"played": 2, "won": 2, "win_rate": 100.0},
                    "4": {"played": 2, "won": 2, "win_rate": 100.0},
                    "5": {"played": 2, "won": 2, "win_rate": 100.0},
                    "6": {"played": 2, "won": 1, "win_rate": 50.0},
                    "7": {"played": 2, "won": 1, "win_rate": 50.0},
                    "8": {"played": 2, "won": 1, "win_rate": 50.0},
                    "9": {"played": 2, "won": 1, "win_rate": 50.0},
                    "10": {"played": 1, "won": 1, "win_rate": 100.0},
                    "11": {"played": 1, "won": 1, "win_rate": 100.0},
                    "12": {"played": 1, "won": 0, "win_rate": 0.0},
                    "13": {"played": 2, "won": 1, "win_rate": 50.0},
                    "14": {"played": 2, "won": 1, "win_rate": 50.0},
                    "15": {"played": 2, "won": 1, "win_rate": 50.0},
                    "16": {"played": 2, "won": 1, "win_rate": 50.0}
                }
            },
            "å°è±": {
                "name": "å°è±",
                "teams": ["äººç”Ÿæªé›£"],
                "total_sets_played": 1,
                "total_sets_won": 0,
                "total_win_rate": 0.0,
                "matches_played": 1,
                "set_details": {
                    "1": {"played": 0, "won": 0, "win_rate": 0.0},
                    "2": {"played": 0, "won": 0, "win_rate": 0.0},
                    "3": {"played": 0, "won": 0, "win_rate": 0.0},
                    "4": {"played": 0, "won": 0, "win_rate": 0.0},
                    "5": {"played": 0, "won": 0, "win_rate": 0.0},
                    "6": {"played": 1, "won": 0, "win_rate": 0.0},
                    "7": {"played": 0, "won": 0, "win_rate": 0.0},
                    "8": {"played": 0, "won": 0, "win_rate": 0.0},
                    "9": {"played": 0, "won": 0, "win_rate": 0.0},
                    "10": {"played": 0, "won": 0, "win_rate": 0.0},
                    "11": {"played": 0, "won": 0, "win_rate": 0.0},
                    "12": {"played": 0, "won": 0, "win_rate": 0.0},
                    "13": {"played": 0, "won": 0, "win_rate": 0.0},
                    "14": {"played": 0, "won": 0, "win_rate": 0.0},
                    "15": {"played": 0, "won": 0, "win_rate": 0.0},
                    "16": {"played": 0, "won": 0, "win_rate": 0.0}
                }
            }
        };

        const mockTeamData = {
            "äººç”Ÿæªé›£": [
                // åŸºæ–¼HTMLæå–çš„çœŸå¯¦ä¸»åŠ›é¸æ‰‹ï¼ˆæ¨¡æ“¬æ•¸æ“šï¼Œéœ€è¦èˆ‡player performanceæ•¸æ“šå°æ‡‰ï¼‰
                {
                    "name": "å°å‚…",
                    "teams": ["äººç”Ÿæªé›£"],
                    "total_sets_played": 44,
                    "total_sets_won": 23,
                    "total_win_rate": 52.3,
                    "matches_played": 10
                },
                {
                    "name": "å°å§œ",
                    "teams": ["äººç”Ÿæªé›£"],
                    "total_sets_played": 52,
                    "total_sets_won": 28,
                    "total_win_rate": 53.8,
                    "matches_played": 14
                },
                {
                    "name": "å°é­š",
                    "teams": ["äººç”Ÿæªé›£"],
                    "total_sets_played": 48,
                    "total_sets_won": 22,
                    "total_win_rate": 45.8,
                    "matches_played": 14
                },
                {
                    "name": "å®—ç‡",
                    "teams": ["äººç”Ÿæªé›£"],
                    "total_sets_played": 45,
                    "total_sets_won": 18,
                    "total_win_rate": 40.0,
                    "matches_played": 13
                },
                {
                    "name": "äº®äº®",
                    "teams": ["äººç”Ÿæªé›£"],
                    "total_sets_played": 42,
                    "total_sets_won": 16,
                    "total_win_rate": 38.1,
                    "matches_played": 13
                }
            ],
            "é†‰è²©": [
                // åŸºæ–¼HTMLæå–çš„çœŸå¯¦ä¸»åŠ›é¸æ‰‹ï¼ˆæ¨¡æ“¬æ•¸æ“šï¼Œéœ€è¦èˆ‡player performanceæ•¸æ“šå°æ‡‰ï¼‰
                {
                    "name": "å°é£›",
                    "teams": ["é†‰è²©"],
                    "total_sets_played": 91,
                    "total_sets_won": 52,
                    "total_win_rate": 57.1,
                    "matches_played": 14
                },
                {
                    "name": "å°é½Š",
                    "teams": ["é†‰è²©"],
                    "total_sets_played": 68,
                    "total_sets_won": 34,
                    "total_win_rate": 50.0,
                    "matches_played": 12
                },
                {
                    "name": "Ray",
                    "teams": ["é†‰è²©"],
                    "total_sets_played": 42,
                    "total_sets_won": 21,
                    "total_win_rate": 50.0,
                    "matches_played": 8
                },
                {
                    "name": "å‡±å“¥",
                    "teams": ["é†‰è²©"],
                    "total_sets_played": 38,
                    "total_sets_won": 18,
                    "total_win_rate": 47.4,
                    "matches_played": 8
                },
                {
                    "name": "é˜¿å† ",
                    "teams": ["é†‰è²©"],
                    "total_sets_played": 35,
                    "total_sets_won": 16,
                    "total_win_rate": 45.7,
                    "matches_played": 8
                }
            ]
        };

        // æ¸¬è©¦çš„é¸æ‰‹å’ŒéšŠä¼
        const testPlayers = ['Ace', 'Lucas', 'è€ä¸¹'];
        const testTeams = ['äººç”Ÿæªé›£', 'é†‰è²©'];

        // æ ¼å¼åŒ–å‹ç‡é¡è‰²
        function getWinRateClass(winRate) {
            if (winRate >= 70) return 'excellent';
            if (winRate >= 60) return 'good';
            if (winRate >= 50) return 'average';
            if (winRate >= 40) return 'below_average';
            return 'poor';
        }

        // ç²å–è¡¨ç¾ç­‰ç´š
        function getPerformanceLevel(winRate, played) {
            if (played < 3) return 'insufficient_data';
            if (winRate >= 80) return 'excellent';
            if (winRate >= 65) return 'good';
            if (winRate >= 50) return 'average';
            if (winRate >= 35) return 'below_average';
            return 'poor';
        }

        // é¡¯ç¤ºé¸æ‰‹è©³ç´°è³‡æ–™
        function displayPlayerDetails(player) {
            if (!player) {
                return `<div class="error">é¸æ‰‹è³‡æ–™æœªæ‰¾åˆ°</div>`;
            }

            const setPerformance = [];
            for (let i = 1; i <= 16; i++) {
                const setData = player.set_details[i.toString()];
                const level = getPerformanceLevel(setData.win_rate, setData.played);
                setPerformance.push(`
                    <div class="set-item ${level}" title="SET${i}: ${setData.played}å ´ ${setData.won}å‹ (${setData.win_rate}%)">
                        SET${i}<br>${setData.win_rate}%
                    </div>
                `);
            }

            return `
                <div class="player-card">
                    <h3>ğŸ† ${player.name} (${player.teams.join('/')})</h3>
                    
                    <div class="stats-grid">
                        <div class="stat-item">
                            <strong>ç¸½å‡ºè³½</strong><br>
                            <span style="font-size: 1.5em; color: #007bff;">${player.total_sets_played}</span>å ´
                        </div>
                        <div class="stat-item">
                            <strong>ç¸½å‹å ´</strong><br>
                            <span style="font-size: 1.5em; color: #28a745;">${player.total_sets_won}</span>å ´
                        </div>
                        <div class="stat-item">
                            <strong>ç¸½å‹ç‡</strong><br>
                            <span style="font-size: 1.5em;" class="${getWinRateClass(player.total_win_rate)}">${player.total_win_rate}%</span>
                        </div>
                        <div class="stat-item">
                            <strong>åƒèˆ‡æ¯”è³½</strong><br>
                            <span style="font-size: 1.5em; color: #6c757d;">${player.matches_played}</span>å ´
                        </div>
                    </div>

                    <h4>SET 1-16 è¡¨ç¾åˆ†å¸ƒï¼š</h4>
                    <div class="set-performance">
                        ${setPerformance.join('')}
                    </div>
                    
                    <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                        <strong>åœ–ä¾‹ï¼š</strong>
                        <span class="set-item excellent" style="display: inline-block; margin: 2px;">å„ªç§€(80%+)</span>
                        <span class="set-item good" style="display: inline-block; margin: 2px;">è‰¯å¥½(65%+)</span>
                        <span class="set-item average" style="display: inline-block; margin: 2px;">ä¸€èˆ¬(50%+)</span>
                        <span class="set-item below_average" style="display: inline-block; margin: 2px;">å¾…æ”¹å–„(35%+)</span>
                        <span class="set-item poor" style="display: inline-block; margin: 2px;">è¼ƒå·®(35%-)</span>
                        <span class="set-item insufficient_data" style="display: inline-block; margin: 2px;">æ•¸æ“šä¸è¶³</span>
                    </div>
                </div>
            `;
        }

        // é¡¯ç¤ºéšŠä¼è©³ç´°è³‡æ–™
        function displayTeamDetails(teamName, players) {
            if (!players || players.length === 0) {
                return `
                    <div class="team-card">
                        <h3>âŒ ${teamName}</h3>
                        <div class="error">éšŠä¼è³‡æ–™æœªæ‰¾åˆ°æˆ–ç„¡é¸æ‰‹æ•¸æ“š</div>
                    </div>
                `;
            }

            // è¨ˆç®—éšŠä¼çµ±è¨ˆ
            const totalSetsPlayed = players.reduce((sum, p) => sum + p.total_sets_played, 0);
            const totalSetsWon = players.reduce((sum, p) => sum + p.total_sets_won, 0);
            const teamWinRate = totalSetsPlayed > 0 ? (totalSetsWon / totalSetsPlayed * 100).toFixed(1) : 0;
            
            // æŒ‰å‡ºè³½æ¬¡æ•¸æ’åº
            players.sort((a, b) => b.total_sets_played - a.total_sets_played);

            const playersHtml = players.map(player => `
                <tr>
                    <td style="padding: 8px; border-bottom: 1px solid #eee;">${player.name}</td>
                    <td style="padding: 8px; border-bottom: 1px solid #eee; text-align: center;">${player.total_sets_played}</td>
                    <td style="padding: 8px; border-bottom: 1px solid #eee; text-align: center;">${player.total_sets_won}</td>
                    <td style="padding: 8px; border-bottom: 1px solid #eee; text-align: center;">
                        <span class="${getWinRateClass(player.total_win_rate)}" style="padding: 2px 6px; border-radius: 3px; color: white;">
                            ${player.total_win_rate}%
                        </span>
                    </td>
                    <td style="padding: 8px; border-bottom: 1px solid #eee; text-align: center;">${player.matches_played}</td>
                </tr>
            `).join('');

            return `
                <div class="team-card">
                    <h3>ğŸ¢ ${teamName}</h3>
                    
                    <div class="stats-grid">
                        <div class="stat-item">
                            <strong>éšŠä¼é¸æ‰‹æ•¸</strong><br>
                            <span style="font-size: 1.5em; color: #007bff;">${players.length}</span>äºº
                        </div>
                        <div class="stat-item">
                            <strong>ç¸½å‡ºè³½æ¬¡æ•¸</strong><br>
                            <span style="font-size: 1.5em; color: #6c757d;">${totalSetsPlayed}</span>å ´
                        </div>
                        <div class="stat-item">
                            <strong>ç¸½å‹å ´æ•¸</strong><br>
                            <span style="font-size: 1.5em; color: #28a745;">${totalSetsWon}</span>å ´
                        </div>
                        <div class="stat-item">
                            <strong>éšŠä¼å‹ç‡</strong><br>
                            <span style="font-size: 1.5em;" class="${getWinRateClass(teamWinRate)}">${teamWinRate}%</span>
                        </div>
                    </div>

                    <h4>é¸æ‰‹è¡¨ç¾åˆ—è¡¨ï¼š</h4>
                    <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
                        <thead>
                            <tr style="background-color: #f8f9fa;">
                                <th style="padding: 10px; text-align: left; border-bottom: 2px solid #dee2e6;">é¸æ‰‹</th>
                                <th style="padding: 10px; text-align: center; border-bottom: 2px solid #dee2e6;">ç¸½å‡ºè³½</th>
                                <th style="padding: 10px; text-align: center; border-bottom: 2px solid #dee2e6;">ç¸½å‹å ´</th>
                                <th style="padding: 10px; text-align: center; border-bottom: 2px solid #dee2e6;">å‹ç‡</th>
                                <th style="padding: 10px; text-align: center; border-bottom: 2px solid #dee2e6;">åƒèˆ‡æ¯”è³½</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${playersHtml}
                        </tbody>
                    </table>
                </div>
            `;
        }

        // ä½¿ç”¨å…§åµŒæ•¸æ“šé€²è¡Œæ¸¬è©¦
        function runMockTests() {
            console.log('é–‹å§‹åŸ·è¡Œå…§åµŒæ¸¬è©¦æ•¸æ“š...');
            
            // æ¸¬è©¦é¸æ‰‹æ•¸æ“š
            const playersContainer = document.getElementById('players-results');
            let playersHtml = '<div class="success">âœ… ä½¿ç”¨å…§åµŒæ¸¬è©¦æ•¸æ“šè¼‰å…¥æˆåŠŸ</div>';

            for (const playerName of testPlayers) {
                const playerData = mockPlayerData[playerName];
                playersHtml += displayPlayerDetails(playerData);
            }

            playersContainer.innerHTML = playersHtml;

            // æ¸¬è©¦éšŠä¼æ•¸æ“š
            const teamsContainer = document.getElementById('teams-results');
            let teamsHtml = '<div class="success">âœ… ä½¿ç”¨å…§åµŒæ¸¬è©¦æ•¸æ“šè¼‰å…¥æˆåŠŸ</div>';

            for (const teamName of testTeams) {
                const teamPlayers = mockTeamData[teamName];
                teamsHtml += displayTeamDetails(teamName, teamPlayers);
            }

            teamsContainer.innerHTML = teamsHtml;
            
            console.log('å…§åµŒæ¸¬è©¦æ•¸æ“šåŸ·è¡Œå®Œæˆï¼');
        }

        // å˜—è©¦åŸå§‹APIæ¸¬è©¦ï¼ˆéœ€è¦HTTPæœå‹™å™¨ï¼‰
        async function runAPITests() {
            try {
                // å…ˆè¼‰å…¥ä¿®æ­£å¾Œçš„æ•¸æ“š
                const response = await fetch('firebase_data/season3_player_performance_corrected.json');
                const data = await response.json();
                window.season3PlayerData = data.season3_player_performance.players;
                
                // æ¨¡æ“¬APIå‡½æ•¸
                window.getSeason3PlayerDetails = function(playerName) {
                    return window.season3PlayerData[playerName] || null;
                };
                
                window.getSeason3TeamPlayers = function(teamName) {
                    const teamPlayers = [];
                    for (const [name, player] of Object.entries(window.season3PlayerData)) {
                        // ç°¡åŒ–çš„éšŠä¼åˆ¤æ–·é‚è¼¯
                                                 const knownTeams = {
                             // é€ƒç”Ÿå…¥å£C (ä¸»åŠ›é¸æ‰‹)
                             'è¯è¯': 'é€ƒç”Ÿå…¥å£C', 'éš¼éš¼': 'é€ƒç”Ÿå…¥å£C', 'Ace': 'é€ƒç”Ÿå…¥å£C', 'é˜¿ä»': 'é€ƒç”Ÿå…¥å£C',
                             'ç¦¹è¾°': 'é€ƒç”Ÿå…¥å£C', 'å°æ­ª': 'é€ƒç”Ÿå…¥å£C', 'å–‡å­': 'é€ƒç”Ÿå…¥å£C',
                             
                             // é€ƒç”Ÿå…¥å£A (ä¸»åŠ›é¸æ‰‹)  
                             'Jesse': 'é€ƒç”Ÿå…¥å£A', 'Lucas': 'é€ƒç”Ÿå…¥å£A', 'å­Ÿç‘„': 'é€ƒç”Ÿå…¥å£A', 'å°å€«': 'é€ƒç”Ÿå…¥å£A',
                             'Terry': 'é€ƒç”Ÿå…¥å£A', 'é˜¿æ¨‚': 'é€ƒç”Ÿå…¥å£A', 'Eric': 'é€ƒç”Ÿå…¥å£A',
                             
                             // Viviæœé…’æ™šèˆ (ä¸»åŠ›é¸æ‰‹)
                             'çŒ´å­': 'Viviæœé…’æ™šèˆ', 'é˜¿æ·¦': 'Viviæœé…’æ™šèˆ', 'è€ä¸¹': 'Viviæœé…’æ™šèˆ', 'å°èŠ¬': 'Viviæœé…’æ™šèˆ',
                             'é˜¿å€«': 'Viviæœé…’æ™šèˆ', 'æ€ªé ­': 'Viviæœé…’æ™šèˆ', 'Kelvin': 'Viviæœé…’æ™šèˆ',
                             
                             // äººç”Ÿæªé›£ (ä¸»åŠ›é¸æ‰‹)
                             'å°å§œ': 'äººç”Ÿæªé›£', 'å°é­š': 'äººç”Ÿæªé›£', 'å®—ç‡': 'äººç”Ÿæªé›£', 'äº®äº®': 'äººç”Ÿæªé›£',
                             'ç¾¿ç©': 'äººç”Ÿæªé›£', 'å°å‚…': 'äººç”Ÿæªé›£', 'æ­ªæ­ª': 'äººç”Ÿæªé›£', 'é˜¿æœ‹': 'äººç”Ÿæªé›£',
                             
                             // é†‰è²© (ä¸»åŠ›é¸æ‰‹)
                             'å°é£›': 'é†‰è²©', 'å°é½Š': 'é†‰è²©', 'Ray': 'é†‰è²©', 'å‡±å“¥': 'é†‰è²©',
                             'é˜¿å† ': 'é†‰è²©', 'ç‰ç±³': 'é†‰è²©', 'é˜¿é„§': 'é†‰è²©', 'å®å“¥': 'é†‰è²©',
                             
                             // æµ·ç›œæªç¡¬ (ä¸»åŠ›é¸æ‰‹)
                             'å°è–©': 'æµ·ç›œæªç¡¬', 'é˜¿è‚¥': 'æµ·ç›œæªç¡¬', 'è˜‡ã„Ÿ': 'æµ·ç›œæªç¡¬', 'èˆ¹é•·': 'æµ·ç›œæªç¡¬',
                             'å°å‰': 'æµ·ç›œæªç¡¬', 'é˜¿ç¥º': 'æµ·ç›œæªç¡¬', 'Louis': 'æµ·ç›œæªç¡¬',
                             
                             // é…’ç©ºçµ„ (ä¸»åŠ›é¸æ‰‹)
                             'æ…¶æ–‡': 'é…’ç©ºçµ„', 'èŒƒå§œå§': 'é…’ç©ºçµ„', 'èŒƒå§œå“¥': 'é…’ç©ºçµ„', 'å®“å“¥': 'é…’ç©ºçµ„',
                             'ç„¡å': 'é…’ç©ºçµ„', 'ç˜¦å­': 'é…’ç©ºçµ„', 'è™å“¥': 'é…’ç©ºçµ„',
                             
                             // Jack (ä¸»åŠ›é¸æ‰‹)
                             'é˜¿ç¦': 'Jack', 'è€å¸«': 'Jack', 'Bå“¥': 'Jack', 'Stan': 'Jack',
                             'è€€æ¥ ': 'Jack', 'é˜¿ä¿Š': 'Jack', '+0': 'Jack', 'å°å»º': 'Jack'
                         };
                        if (knownTeams[name] === teamName) {
                            teamPlayers.push(player);
                        }
                    }
                    return teamPlayers.sort((a, b) => b.total_sets_played - a.total_sets_played);
                };
                

                // æ¸¬è©¦é¸æ‰‹æ•¸æ“š
                console.log('é–‹å§‹æ¸¬è©¦é¸æ‰‹æ•¸æ“š...');
                const playersContainer = document.getElementById('players-results');
                let playersHtml = '<div class="success">âœ… ä½¿ç”¨ä¿®æ­£å¾Œçš„APIæ•¸æ“šè¼‰å…¥æˆåŠŸ</div>';

                for (const playerName of testPlayers) {
                    console.log(`ç²å–é¸æ‰‹æ•¸æ“š: ${playerName}`);
                    const playerData = getSeason3PlayerDetails(playerName);
                    playersHtml += displayPlayerDetails(playerData);
                }

                playersContainer.innerHTML = playersHtml;

                // æ¸¬è©¦éšŠä¼æ•¸æ“š
                console.log('é–‹å§‹æ¸¬è©¦éšŠä¼æ•¸æ“š...');
                const teamsContainer = document.getElementById('teams-results');
                let teamsHtml = '<div class="success">âœ… ä½¿ç”¨ä¿®æ­£å¾Œçš„APIæ•¸æ“šè¼‰å…¥æˆåŠŸ</div>';

                for (const teamName of testTeams) {
                    console.log(`ç²å–éšŠä¼æ•¸æ“š: ${teamName}`);
                    const teamPlayers = getSeason3TeamPlayers(teamName);
                    teamsHtml += displayTeamDetails(teamName, teamPlayers);
                }

                teamsContainer.innerHTML = teamsHtml;
                
                console.log('æ‰€æœ‰APIæ¸¬è©¦å®Œæˆï¼');

            } catch (error) {
                console.error('APIæ¸¬è©¦éç¨‹ä¸­ç™¼ç”ŸéŒ¯èª¤:', error);
                document.getElementById('players-results').innerHTML = `<div class="error">è¼‰å…¥é¸æ‰‹æ•¸æ“šæ™‚ç™¼ç”ŸéŒ¯èª¤: ${error.message}<br><br>è«‹å˜—è©¦ä½¿ç”¨å…§åµŒæ¸¬è©¦æ•¸æ“šæˆ–å•Ÿå‹•HTTPæœå‹™å™¨</div>`;
                document.getElementById('teams-results').innerHTML = `<div class="error">è¼‰å…¥éšŠä¼æ•¸æ“šæ™‚ç™¼ç”ŸéŒ¯èª¤: ${error.message}<br><br>è«‹å˜—è©¦ä½¿ç”¨å…§åµŒæ¸¬è©¦æ•¸æ“šæˆ–å•Ÿå‹•HTTPæœå‹™å™¨</div>`;
            }
        }

        // é é¢è¼‰å…¥å®Œæˆå¾Œå˜—è©¦APIæ¸¬è©¦
        document.addEventListener('DOMContentLoaded', function() {
            console.log('é é¢è¼‰å…¥å®Œæˆï¼Œå˜—è©¦åŸ·è¡ŒAPIæ¸¬è©¦...');
            runAPITests();
        });
    </script>
</body>
</html> 